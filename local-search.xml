<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>对于旁路盲注攻击的缓解：RFC5961</title>
    <link href="/2023/11/07/RFC5961/"/>
    <url>/2023/11/07/RFC5961/</url>
    
    <content type="html"><![CDATA[<h2 id="RFC5961-之前"><a href="#RFC5961-之前" class="headerlink" title="RFC5961 之前"></a>RFC5961 之前</h2><p>tcp 连接面临旁路攻击者的威胁，旁路攻击者可以通过盲注 RST，ACK，DATA 报文的方式来关闭，重置连接或者注入数据。<br>旁路攻击者与 MITM 攻击者相对，其不在通信链路上，无法窃听到链路上的报文。</p><h3 id="攻击方法"><a href="#攻击方法" class="headerlink" title="攻击方法"></a>攻击方法</h3><h4 id="RST-攻击"><a href="#RST-攻击" class="headerlink" title="RST 攻击"></a>RST 攻击</h4><ul><li><strong>描述</strong>：攻击者发送一个设置了 RST（重置）标志的 TCP 段。</li><li><strong>目的</strong>：通过使接收端认为另一端已发出终止连接的信号，以提前终止 TCP 连接。</li><li><strong>开销</strong>：平均需要$2^{31}/window$个报文完成攻击</li></ul><h4 id="SYN-攻击"><a href="#SYN-攻击" class="headerlink" title="SYN 攻击"></a>SYN 攻击</h4><ul><li><strong>描述</strong>：攻击者发送一个设置了 SYN（同步）标志的 TCP 段。</li><li><strong>目的</strong>：欺骗接收者，使其认为发送者已经发起了一个新的连接请求，导致现有连接状态被拆除。</li><li><strong>开销</strong>：平均需要$2^{31}/window$个报文完成攻击</li></ul><h4 id="数据注入"><a href="#数据注入" class="headerlink" title="数据注入"></a>数据注入</h4><ul><li><strong>描述</strong>：攻击者尝试注入包含有效载荷数据的 TCP 段。</li><li><strong>目的</strong>：破坏正在进行的传输的数据，导致数据完整性问题。</li><li><strong>开销</strong>：平均需要$2^{32}/window$个报文完成攻击，这里因为数据报文需要检验 ACK 字段，即需要满足如下关系$(SND.UNA-(2^31-1)) &lt;= SEG.ACK &lt;= SND.NXT$.对于每个猜测的 SEQ 需要 ACK 空间（32 比特循环群）上的两个元素才能确保被接受。</li></ul><p>过去通常认为这种攻击是不会发生的，因为$2^{32}$的序列空间使得$SEG.SEQ == RCV.NXT$概率极小，但实际并非如此，seq 号只需要命中窗口即可（$RCV.NXT &lt;= SEG.SEQ &lt; RCV.NXT+RCV.WND$），攻击者实际上平均只需要$2^{31}/window$个报文即可完成完成攻击。这在当前的接入带宽下是非常容易完成的。</p><h3 id="RFC5961-缓解-1-措施"><a href="#RFC5961-缓解-1-措施" class="headerlink" title="RFC5961 缓解[1]措施"></a>RFC5961 缓解<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="~~TCP 这个白左创造的乌托邦适用的通信协议因为兼容性问题确实难以替代，只能通过这种打补丁的形式来修漏洞。~~">[1]</span></a></sup>措施</h3><h3 id="SYN-攻击的缓解措施"><a href="#SYN-攻击的缓解措施" class="headerlink" title="SYN 攻击的缓解措施"></a>SYN 攻击的缓解措施</h3><ol><li><p><strong>挑战 ACK</strong>:</p><ul><li>不论序列号如何，如果接收到的 TCP 段设置了 SYN 位，TCP 必须向远程对等方发送 ACK 响应（挑战 ACK）。</li><li>发送格式为 <code>&lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</code>。</li><li>发送挑战 ACK 后，TCP 必须丢弃该段，并停止进一步处理。</li></ul></li><li><p><strong>合法对等方的行为</strong>:</p><ul><li>合法的对等方在重启后不应在同步状态下有 TCP 控制块（TCB）。</li><li>当挑战 ACK 到达时，如果对等方确实重新启动了，它应响应一个 RST 段，序列号基于引起 RST 的 ACK 字段。</li></ul></li><li><p><strong>伪造 SYN 的处理</strong>:</p><ul><li>伪造的 SYN 将产生一个额外的 ACK。</li><li>远程对等方将这个额外的 ACK 视为重复的 ACK 并丢弃，从而不影响已建立的连接。</li></ul></li><li><p><strong>非放大 ACK 交换</strong>:</p><ul><li>这种缓解措施可能导致非放大的 ACK 交换，即不会增加网络流量的 ACK 响应。</li></ul></li></ol><h3 id="RST-攻击的缓解措施"><a href="#RST-攻击的缓解措施" class="headerlink" title="RST 攻击的缓解措施"></a>RST 攻击的缓解措施</h3><ol><li><p><strong>挑战 ACK</strong>:</p><ul><li>如果 RST 位被设置并且序列号不完全匹配下一个预期的序列值，但在当前接收窗口内，TCP 必须发送一个确认（挑战 ACK）。</li><li>发送格式为 <code>&lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</code>。</li><li>发送挑战 ACK 后，TCP 必须丢弃不可接受的段，并停止进一步处理进来的包。接下来的对这个连接的段将正常处理。</li></ul></li><li><p><strong>RST 段的处理</strong>:</p><ul><li>在除 SYN-SENT 外的所有状态中，所有重置（RST）段都通过检查它们的序列号字段来验证。</li><li>如果 RST 段到达并且其序列号字段不匹配下一个预期的序列号但在窗口内，则接收者应该生成一个 ACK。</li><li>在其他所有情况下，如果序列号不匹配且在窗口外，接收者必须默默丢弃该段。</li></ul></li><li><p><strong>远程对等方生成 RST</strong>:</p><ul><li>如果远程对等方确实生成了一个 RST，但它未满足上述标准（RST 序列号在窗口内但不是确切预期的序列号），当挑战 ACK 发回时，它将不再有与此连接相关的传输控制块（TCB），因此根据 RFC 793，远程对等方将发回第二个 RST。</li><li>第二个 RST 的序列号来自入站 ACK 的确认号。如果第二个 RST 到达发送方，将导致连接中止，因为序列号现在完全匹配。</li></ul></li></ol><h3 id="数据注入攻击的缓解措施"><a href="#数据注入攻击的缓解措施" class="headerlink" title="数据注入攻击的缓解措施"></a>数据注入攻击的缓解措施</h3><ol><li><p><strong>ACK 值的校验</strong>:</p><ul><li>所有 TCP 栈都可以实施以下缓解措施。实施此缓解措施的 TCP 栈必须对任何进入的段添加一个额外的输入检查。</li><li>ACK 值只有在 <code>((SND.UNA - MAX.SND.WND) &lt;= SEG.ACK &lt;= SND.NXT)</code> 范围内才被认为是可接受的。</li><li>所有 ACK 值不满足上述条件的进入段必须被丢弃，并且回送一个 ACK。</li></ul></li><li><p><strong>MAX.SND.WND 状态变量</strong>:</p><ul><li>定义一个新的状态变量 MAX.SND.WND，作为本地发送方曾经从其对等方接收到的最大窗口。</li><li>这个小检查将减少攻击者猜测一个有效序列号的脆弱性，因为不仅要猜到窗口内的序列号，还要猜到一个在特定范围内的正确 ACK 值。</li></ul></li><li><p><strong>提高对 FIN 段的健壮性</strong>:</p><ul><li>这种缓解措施还有助于提高对接受伪造 FIN 段（FIN 攻击）的健壮性。</li><li>攻击者也需要让确认号落在上述范围内，以成功伪造一个 FIN 段导致连接关闭。</li></ul></li></ol><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>文档对于这三种对于 tcp 状态机的修改，前两种应该被实现，最后一种由开发者决定是否实现。因为在 RFC</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><del>TCP 这个白左创造的乌托邦适用的通信协议因为兼容性问题确实难以替代，只能通过这种打补丁的形式来修漏洞。</del><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>RFC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tcp/ip_protocols</title>
    <link href="/2023/09/12/tcp-ip-protocols/"/>
    <url>/2023/09/12/tcp-ip-protocols/</url>
    
    <content type="html"><![CDATA[<p>网络协议的实现：分层体系结构<br>互联网络的目标之一是对应用隐藏所有关于物理布局（拓扑）和低层协议的异构性的细<br>节。<br>icmp 3,4 linux系统（路由器）收到这个保温之后，将检查tcp端口号以及ip</p>]]></content>
    
    
    
    <tags>
      
      <tag>计算机网络 tcpip协议栈</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>保研记录</title>
    <link href="/2023/09/11/%E4%BF%9D%E7%A0%94%E8%AE%B0%E5%BD%95/"/>
    <url>/2023/09/11/%E4%BF%9D%E7%A0%94%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="保研记录帖"><a href="#保研记录帖" class="headerlink" title="保研记录帖"></a>保研记录帖</h1><p>随着清华预推免系统显示出<strong>初步录取</strong>的时候，可能我的保研就已经基本上结束了，后面就等待928填写系统了。</p><h2 id="本人bg"><a href="#本人bg" class="headerlink" title="本人bg"></a>本人bg</h2><p>京内某211，网安相关专业。rk 1/34。无国奖，水赛若干。</p><h2 id="清华保研流程"><a href="#清华保研流程" class="headerlink" title="清华保研流程"></a>清华保研流程</h2><h3 id="critical-step"><a href="#critical-step" class="headerlink" title="critical step"></a>critical step</h3><p>我从大三一开学就联系了一个老师，经过面试之后，加入实验室开展科研工作，最后顺利留在老师的实验室中。</p><h3 id="夏令营"><a href="#夏令营" class="headerlink" title="夏令营"></a>夏令营</h3><p>仅有机试。机试很难，5！dfs暴力枚举+大模拟（卡卡颂）+较难算法题（忘记了），大部分人打了100分。125分即可免机试进入九推直博（对硕士无效）。</p><h3 id="九推"><a href="#九推" class="headerlink" title="九推"></a>九推</h3><p>包括机试，综合面试，专业面试。分别占20% 5% 75%。机试比夏令营简单，但本fw因为时间安排不当，仍旧只打了100。综合面相当轻松，中文自我介绍加上朗读一段英文文献。因为本人网安背景，恰巧抽到网安相关的文段，当时我笑称文段是“为我准备的”。面试氛围较为轻松。专业面试占比较大，决定了能否被录取，首先进行自我ppt介绍后，由老师提问专业问题。没有提难为我的问题，最后也是顺利通过。</p>]]></content>
    
    
    
    <tags>
      
      <tag>保研</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>最近的生活</title>
    <link href="/2023/04/15/%E6%9C%80%E8%BF%91%E7%9A%84%E7%94%9F%E6%B4%BB/"/>
    <url>/2023/04/15/%E6%9C%80%E8%BF%91%E7%9A%84%E7%94%9F%E6%B4%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="大创答辩-答辩大创"><a href="#大创答辩-答辩大创" class="headerlink" title="大创答辩 答辩大创"></a>大创答辩 答辩大创</h1><h2 id="不的"><a href="#不的" class="headerlink" title="不的"></a>不的</h2><p>公式测试</p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mo>±</mo><msqrt><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">c = \pm\sqrt{a^2 + b^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.12661100000000003em;"></span><span class="mord">±</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.913389em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.873389em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.12661100000000003em;"><span></span></span></span></span></span></span></span></span><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.985ex;" xmlns="http://www.w3.org/2000/svg" width="4.653ex" height="2.942ex" role="img" focusable="false" viewBox="0 -864.9 2056.8 1300.3" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-1-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-1-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-1-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(851.6,394) scale(0.707)"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use></g><g data-mml-node="mrow" transform="translate(220,-377.4) scale(0.707)"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-1-TEX-I-1D465"></use></g><g data-mml-node="mn" transform="translate(605,289) scale(0.707)"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(1008.6,0)"><use data-c="2212" xlink:href="#MJX-1-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(1786.6,0)"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use></g></g><rect width="1816.8" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">int <span class="hljs-keyword">x</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-comment">;</span><br><span class="hljs-keyword">x</span>++<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="/img/hacker.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>misc</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
